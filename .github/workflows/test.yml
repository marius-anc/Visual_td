name: Trigger Azure DevOps Pipeline

on:
  push:
    branches:
      - main   # adjust this branch if needed
  workflow_dispatch: # allows manual trigger

jobs:
  trigger-pipeline:
    runs-on: ubuntu-latest

    steps:
      # - name: Trigger Azure DevOps Pipeline
      #   uses: azure/pipelines@v1.2
      #   with:
      #     azure-devops-project-url: https://dev.azure.com/mariusancutescu/Bosch-assigment
      #     azure-pipeline-name: testgh
      #     azure-devops-token: ${{ secrets.AZURE_DEVOPS_TOKEN }}
      #     azure-pipeline-variables:  '{"variable1": "value1", "variable2": "value2"}' # optional stringified json

      # - name: Azure CLI Login
      #   uses: azure/login@v1
      #   with:
      #     creds: ${{ secrets.AZURE_CREDENTIALS }}

      # - name: Install Azure DevOps Extension
      #   run: az extension add --name azure-devops

      # - name: Trigger Azure DevOps Pipeline
      #   run: |
      #     az pipelines run \
      #       --name "testgh" \
      #       --organization "https://dev.azure.com/mariusancutescu" \
      #       --project "Bosch-assigment" \
      #       --parameters variable1=value1 variable2=value2

      - name: Configure Azure DevOps Authentication
        run: |
          az devops configure --defaults organization=https://dev.azure.com/mariusancutescu project=Bosch-assigment
          echo ${{ secrets.AZURE_DEVOPS_TOKEN }} | az devops login

      - name: Trigger Azure DevOps Pipeline
        run: |
          az pipelines run \
            --name "testgh" \
            --parameters variable1=value1 variable2=value2